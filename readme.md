# Assignments for STM32CubeIDE and Nucleo Boards

This repository contains the details and instructions for completing the assignments using STM32CubeIDE with Nucleo boards. 

## Assignment 1 

### Overview
- **Goal**: Familiarize with STM32CubeIDE, Nucleo board setup, breadboard, jumper wires, and sensors.
- **Tasks**:
  1. Run the provided code, display outputs, and explain the `.ioc` file configurations and functions.
  2. Toggle LED and print data over UART in a basic setup.
  3. Interface with the BMP280 sensor via I2C.

### Steps:
1. **Basic Setup**:
   - Create a new project using STM32CubeIDE and select the `L07R0Z` Nucleo as the platform.
   - Configure the project using the default `.ioc` file.
   - Add code in `main.c` to toggle an LED and print messages on UART.
   - Verify output using the serial console within the IDE.

2. **Sensor Interfacing**:
   - Download and extract `bmp.tar.gz` containing source files for the BMP280 sensor.
   - Create a new project in STM32CubeIDE.
   - **I2C Configuration**: Enable I2C1 communication in the `.ioc` file.
     - Ensure the SCL and SDA pins are mapped correctly. Adjust the pinout for easier access if needed.
     - Save the `.ioc` file and regenerate the code when prompted.
   - **File Placement**:
     - Place `.h` files in `Core/Inc`.
     - Place `.c` files in `Core/Src`.
     - Modify `main.c` (generated by the IDE) by manually including relevant lines from the provided `main.c` file.
     
   - **Build and Run**:
     - Build and run the project to display sensor readings on the serial console.
     - Debug until the expected output is seen.



## Assignment 2 

### Overview
- **Goal**: Port Arduino libraries for the MAX30102 sensor to STM32, process sensor data, and configure interrupts.
- **Tasks**:
  1. Port Arduino libraries.
  2. Read raw data and display it on the serial console.
  3. Process raw data for meaningful outputs (heartbeat, heart rate, and SpO2).
  4. Configure sensor interrupts.

### Steps:
1. **Library Porting**:
   
   - Create a new project in STM32CubeIDE and configure I2C communication.
   - Place relevant files from the Arduino libraries into `Core/Inc` and `Core/Src`.
   - Define initialization functions and functions for reading raw data in your `main.c`.
   - Ensure the main loop calls initialization and reads raw data, printing the results to the serial console.

2. **Data Processing**:
   
   - Integrate and call these functions from `main.c`.
   

3. **Interrupt Configuration**:
   - Configure the interrupt line for the MAX30102 sensor to enable accurate data readings.



## Assignment 3

### Overview
- **Goal**: Read and write data to an SD card using SPI interface.
- **Tasks**:
  - Use FatFS to manage file read/write operations on an SD card over SPI.

### Steps:
1. **File Placement**:
   - Copy `FATFS/Target/user_diskio_spi.c` and `FATFS/Target/user_diskio_spi.h` into your STM32CubeIDE project.
   - Include `#include "user_diskio_spi.h"` in `FATFS/Target/user_diskio.c`.

2. **Configuration**:
   - Ensure `main.h` contains definitions for `SD_SPI_HANDLE` (e.g., `hspi2`), `SD_CS_GPIO_Port`, and `SD_CS_Pin`.
   - Configure SPI driver speeds and prescalars in `user_diskio_spi.c` for optimal operation.



Here's a README outline for Assignments 4 and 5, focusing on integrating previous work, adding new functionality, and leveraging FreeRTOS middleware for task management and synchronization. The README provides detailed steps and instructions for students on configuring and combining code effectively.

---


## Assignment 4 

### Overview
- **Goal**: Combine code from Assignments 2 and 3 to sense temperature and SpO2 values, compute reliable results, and write the data to a file on an SD card.

### Tasks:
1. Integrate the MAX30102 sensor code (Assignment 2) and SD card file writing functionality (Assignment 3) in a single project.
2. Synchronously read temperature and SpO2 values, process these for accuracy, and store the results in an SD card file.
3. Implement this functionality in a simple `while` loop in the `main.c` file.

### Steps:
1. **Project Setup**:
   - Create a new STM32CubeIDE project and enable necessary peripherals (I2C for the MAX30102 sensor and SPI for the SD card).
   - Include all relevant files from Assignments 2 (`MAX30102 sensor` code) and 3 (`SD card` driver files).

2. **File Placement**:
   - Place `.h` files in `Core/Inc` and `.c` files in `Core/Src`.
   - Ensure any shared variables or constants are appropriately defined and initialized.



## Assignment 5

### Overview
- **Goal**: Use FreeRTOS to create tasks for sensing, processing, and writing data to an SD card, with proper synchronization mechanisms and interrupt handling.

### Tasks:
1. **Part A**: Create FreeRTOS tasks for sensing, processing, and SD card writing.


2. **Part B**: Utilize the hardware temperature interrupt from Assignment 2 and handle it in a FreeRTOS task.


### Steps:

#### Part A: FreeRTOS Task Creation
1. **Setup**:
   - Create a new STM32CubeIDE project with FreeRTOS middleware enabled.
   - Configure I2C and SPI peripherals as required for the MAX30102 sensor and SD card.

2. **Task Creation**:

   - Implement inter-task communication and synchronization using FreeRTOS mechanisms such as queues, semaphores, or mutexes to ensure proper coordination between tasks.
   - Ensure that writing to the SD card only occurs when new data has been received and fully processed.


#### Part B: Interrupt Handling with FreeRTOS
1. **Interrupt Configuration**:
   - Utilize the hardware temperature interrupt from Assignment 2.
   - Create a FreeRTOS task to handle the processing and SD card writing triggered by the interrupt.
   - Ensure that the task performs slower processing work after receiving an interrupt signal.



